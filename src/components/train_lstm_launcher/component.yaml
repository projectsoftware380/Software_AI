name: launch_vertex_ai_lstm_training_job
description: Lanza un Custom Job de Vertex AI para entrenar el modelo LSTM
inputs:
  - {name: project_id, type: String}
  - {name: region, type: String}
  - {name: pair, type: String}
  - {name: timeframe, type: String}
  - {name: params_file, type: String}
  - {name: features_gcs_path, type: String}
  - {name: output_gcs_base_dir, type: String}
  - {name: vertex_training_image_uri, type: String}
  - {name: vertex_machine_type, type: String}
  - {name: vertex_accelerator_type, type: String}
  - {name: vertex_accelerator_count, type: Integer}
  - {name: vertex_service_account, type: String}
outputs:
  - {name: trained_lstm_dir_path, type: String}
implementation:
  container:
    image: gcr.io/trading-ai-460823/trading-ai-gpu:v1
    command:
      - python
      - -m
      - src.components.train_lstm_launcher.task
    args:
      - --project-id
      - {inputValue: project_id}
      - --region
      - {inputValue: region}
      - --pair
      - {inputValue: pair}
      - --timeframe
      - {inputValue: timeframe}
      - --params-file
      - {inputValue: params_file}
      - --features-gcs-path
      - {inputValue: features_gcs_path}
      - --output-gcs-base-dir
      - {inputValue: output_gcs_base_dir}
      - --vertex-training-image-uri
      - {inputValue: vertex_training_image_uri}
      - --vertex-machine-type
      - {inputValue: vertex_machine_type}
      - --vertex-accelerator-type
      - {inputValue: vertex_accelerator_type}
      - --vertex-accelerator-count
      - {inputValue: vertex_accelerator_count}
      - --vertex-service-account
      - {inputValue: vertex_service_account}
      - --trained-lstm-dir-path-output
      - {outputPath: trained_lstm_dir_path}
    resources:
      nvidia_gpu_limit: "1"
