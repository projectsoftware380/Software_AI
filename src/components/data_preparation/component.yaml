# src/components/data_preparation/component.yaml
name: Prepare Training and Holdout Data
description: >
  Loads raw data, computes indicators, and splits the data.

inputs:
  - name: input_data_dir # Cambiado a directorio local
    type: String
    description: 'The local directory containing raw Parquet files from the ingestion step.'
  - name: years_to_keep
    type: Integer
    default: 5
  - name: holdout_months
    type: Integer
    default: 3

outputs:
  - {name: prepared_data_path, type: String}
  - {name: holdout_data_path, type: String}

implementation:
  container:
    image: "europe-west1-docker.pkg.dev/trading-ai-460823/data-ingestion-repo/trading-pipeline-runner:latest"
    command:
      - python
      - -u # Mantener el unbuffered output
      - -m
      - src.components.data_preparation.task
    args:
      - --input-data-dir # Cambiado a directorio local
      - {inputValue: input_data_dir}
      - --years-to-keep
      - {inputValue: years_to_keep}
      - --holdout-months
      - {inputValue: holdout_months}
      - --output-dir # Nuevo argumento para el directorio de salida
      - {outputPath: prepared_data_path} # Usamos prepared_data_path como el directorio base para las salidas
      - --prepared-data-path-output
      - {outputPath: prepared_data_path}
      - --holdout-data-path-output
      - {outputPath: holdout_data_path}