name: model-promotion
description: |
  Decide si el nuevo modelo (LSTM + PPO) debe promoverse a producción
  comparando métricas de back-test con el modelo actual.

inputs:
  # === AJUSTE: Se añade la URI de la imagen como un parámetro de entrada ===
  - name: image_uri
    type: String
    description: 'URI de la imagen Docker a utilizar para ejecutar el componente.'
  # =======================================================================
  - {name: new_metrics_dir,        type: String}
  - {name: new_lstm_artifacts_dir, type: String}
  - {name: new_rl_model_path,      type: String}
  - {name: pair,                   type: String}
  - {name: timeframe,              type: String}
  - {name: production_base_dir,    type: String}

outputs:
  - {name: model_promoted,         type: String, description: "true/false"}

implementation:
  container:
    # === AJUSTE: La imagen ahora es dinámica y viene de los inputs ===
    image: {inputValue: image_uri}
    # ================================================================
    command:
      - python
      - -m
      - src.components.model_promotion.task
    args:
      - --new-metrics-dir
      - {inputValue: new_metrics_dir}
      - --new-lstm-artifacts-dir
      - {inputValue: new_lstm_artifacts_dir}
      - --new-rl-model-path
      - {inputValue: new_rl_model_path}
      - --pair
      - {inputValue: pair}
      - --timeframe
      - {inputValue: timeframe}
      - --production-base-dir
      - {inputValue: production_base_dir}
    fileOutputs:
      model_promoted: /tmp/model_promoted.txt